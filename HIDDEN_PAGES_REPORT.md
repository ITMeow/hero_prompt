# 页面隐藏与 404 配置报告

**日期**: 2025年12月21日
**状态**: 已执行

本以此文档记录了项目中被“软屏蔽”的页面列表及其实现方式。这些页面并未被物理删除，而是通过代码拦截的方式对用户隐藏，并在访问时展示 404 (Not Found) 页面。

## 1. 实现原理

为了防止用户通过拼接 URL 访问特定页面，同时避免 Next.js 在国际化路由中出现死循环错误（`Maximum call stack size exceeded`），我们采用了 **组件级拦截** 的方式。

### 核心策略
不使用 `next/navigation` 的 `notFound()` 函数抛出异常，而是直接在页面组件（Page Component）中渲染根目录下的 404 组件。

**代码模式示例：**

```typescript
// 原始代码被注释或移除
// import { OriginalComponent } from ...

// 引入根目录的 404 组件
import NotFoundPage from '@/app/not-found';

export default function TargetPage() {
  // 直接返回 404 组件，不执行原有逻辑
  return <NotFoundPage />;
  
  // 原有的逻辑代码保留在下方（不可达）或已被移除
}
```

## 2. 被隐藏的页面列表 (共 12 个)

以下文件已被修改为直接返回 404 页面：

| 功能板块 | 对应 URL 路径 (示例) | 文件路径 |
| :--- | :--- | :--- |
| **AI 对话** | `/zh/chat` | `src/app/[locale]/(chat)/chat/page.tsx` |
| **博客列表** | `/zh/blog` | `src/app/[locale]/(landing)/blog/page.tsx` |
| **博客详情** | `/zh/blog/some-post` | `src/app/[locale]/(landing)/blog/[slug]/page.tsx` |
| **博客分类** | `/zh/blog/category/tech` | `src/app/[locale]/(landing)/blog/category/[slug]/page.tsx` |
| **文档** | `/zh/docs` | `src/app/[locale]/(docs)/docs/[[...slug]]/page.tsx` |
| **AI 音乐** | `/zh/ai-music-generator` | `src/app/[locale]/(landing)/(ai)/ai-music-generator/page.tsx` |
| **AI 视频** | `/zh/ai-video-generator` | `src/app/[locale]/(landing)/(ai)/ai-video-generator/page.tsx` |
| **更新日志** | `/zh/updates` | `src/app/[locale]/(landing)/updates/page.tsx` |
| **案例展示** | `/zh/showcases` | `src/app/[locale]/(landing)/showcases/page.tsx` |
| **API 密钥设置** | `/zh/settings/apikeys` | `src/app/[locale]/(landing)/settings/apikeys/page.tsx` |
| **活动记录-对话** | `/zh/activity/chats` | `src/app/[locale]/(landing)/activity/chats/page.tsx` |
| **活动记录-任务** | `/zh/activity/ai-tasks` | `src/app/[locale]/(landing)/activity/ai-tasks/page.tsx` |

## 3. 菜单入口隐藏

除了页面拦截，我们还修改了 Layout 文件以隐藏侧边栏菜单入口。

### Settings (设置) 侧边栏及顶部导航
*   **文件**: `src/app/[locale]/(landing)/settings/layout.tsx`
*   **修改内容**: 
    1.  从 **侧边栏 (nav)** 中移除了 `API Keys` (`/settings/apikeys`)。
    2.  从 **顶部导航 (top_nav)** 中移除了 `Activity` (`/activity`)。

### Activity 侧边栏
*   **文件**: `src/app/[locale]/(landing)/activity/layout.tsx`
*   **修改内容**: 增加过滤逻辑，移除了 URL 包含 `/activity/chats` 和 `/activity/ai-tasks` 的菜单项。

### Chat (对话) 布局
*   **文件**: `src/app/[locale]/(chat)/layout.tsx`
*   **修改内容**: 注释掉了 `DashboardLayout` 和 `sidebar`，使 404 页面能全屏显示，隐藏了左侧的对话历史栏。

## 4. 如何恢复页面 (Restore Guide)

若未来需要恢复上述页面的访问权限，请按照以下步骤操作：

### 步骤 1: 恢复页面内容
找到目标页面的 `page.tsx` 文件，**删除或注释掉**以下代码：

```typescript
import NotFoundPage from '@/app/not-found';
// ...
return <NotFoundPage />;
```

并**取消注释**或**还原**原有的页面逻辑代码（通常是 `return <SomeComponent ... />`）。

### 步骤 2: 恢复菜单入口
1.  **恢复 Settings 菜单**:
    打开 `src/app/[locale]/(landing)/settings/layout.tsx`，删除 `.filter(...)` 中关于 `apikeys` 和 `activity` 的过滤条件。

2.  **恢复 Activity 菜单**:
    打开 `src/app/[locale]/(landing)/activity/layout.tsx`，删除 `.filter(...)` 中关于 `chats` 和 `ai-tasks` 的过滤条件。

---
*Generated by Gemini CLI Agent*
